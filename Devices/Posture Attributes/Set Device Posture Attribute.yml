info:
  name: Set Device Posture Attribute
  type: http
  seq: 1

http:
  method: POST
  url: "{{base_url}}/device/{{device_id}}/attributes/{{attribute_key}}"
  headers:
    - name: Content-Type
      value: application/json
  body:
    type: json
    data: |
      {
        "value": "compliant",
        "expiry": "2026-12-31T00:00:00Z"
      }
  auth:
    type: bearer
    token: "{{access_token}}"

runtime:
  variables:
    - name: attribute_key
      value: custom:compliance_Status

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5

docs: |
  Sets a custom posture attribute on the device.

  attribute_key format: custom:<name> — letters, numbers, underscores only. NO hyphens.
    Valid:   custom:compliance_status, custom:owner, custom:patch_level
    Invalid: custom:compliance-status

  value: string, number, or boolean
  expiry: ISO 8601 UTC timestamp — Tailscale removes the attribute automatically at this time.
    Omit expiry entirely to make the attribute permanent.

  SUCCESS RESPONSE: Tailscale returns null (empty body) with 200 OK on success. This is correct — it does NOT mean failure.
  To verify the attribute was set, run Get Device Attributes.

  To delete immediately instead of waiting for expiry, use: Delete Device Posture Attribute
