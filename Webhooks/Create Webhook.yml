info:
  name: Create Webhook
  type: http
  seq: 3

http:
  method: POST
  url: "{{base_url}}/tailnet/{{tailnet}}/webhooks"
  auth:
    type: bearer
    token: "{{access_token}}"
  headers:
    - name: Content-Type
      value: application/json
  body:
    type: json
    data: |
      {
        "endpointUrl": "https://example.com/webhook",
        "providerType": "slack",
        "subscriptions": [
          "nodeCreated",
          "nodeApproved",
          "nodeKeyExpiringInOneDay",
          "nodeKeyExpired",
          "userDeleted"
        ]
      }

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5

docs: |
  # Create Webhook

  Registers a webhook endpoint to receive event notifications from Tailscale.

  ## providerType

  Controls the payload format. Use `slack` for Slack-compatible JSON, `mattermost`, `googlechat`,
  `discord`, or `custom` for a generic JSON payload.

  ## subscriptions

  Available event types: `nodeCreated`, `nodeApproved`, `nodeNeedsApproval`, `nodeKeyExpiringInOneDay`,
  `nodeKeyExpired`, `nodeDeleted`, `policyUpdate`, `userCreated`, `userDeleted`, `userNeedsApproval`,
  `userRoleUpdated`, `subnetIPForwardingNotEnabled`, `exitNodeIPForwardingNotEnabled`.

  ## Response

  Returns the created webhook object including its `endpointId` â€” save this as `endpoint_id` in your environment.
