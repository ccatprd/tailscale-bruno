info:
  name: List Configuration Audit Logs
  type: http
  seq: 1

http:
  method: GET
  url: "{{base_url}}/tailnet/{{tailnet}}/logging/configuration"
  auth:
    type: bearer
    token: "{{access_token}}"
  params:
    - name: start
      value: "{{log_start}}"
      enabled: true
    - name: end
      value: "{{log_end}}"
      enabled: true
    - name: actor
      value: ""
      enabled: false
    - name: event
      value: ""
      enabled: false

runtime:
  scripts:
    - type: before-request
      code: |
        // Default window: last 30 minutes
        const now = new Date();
        const start = new Date(now.getTime() - 30 * 60 * 1000);
        bru.setVar("log_end", now.toISOString());
        bru.setVar("log_start", start.toISOString());

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5
