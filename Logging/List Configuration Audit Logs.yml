info:
  name: List Configuration Audit Logs
  type: http
  seq: 1

http:
  method: GET
  url: "{{base_url}}/tailnet/{{tailnet}}/logging/configuration"
  auth:
    type: bearer
    token: "{{access_token}}"
  params:
    - name: actor
      value: ""
      enabled: false
    - name: event
      value: ""
      enabled: false

runtime:
  scripts:
    - type: before-request
      code: |
        // Default window: last 30 minutes
        const now = new Date();
        const start = new Date(now.getTime() - 30 * 60 * 1000);
        const url = bru.getEnvVar("base_url") + "/tailnet/" + bru.getEnvVar("tailnet") + "/logging/configuration?start=" + start.toISOString() + "&end=" + now.toISOString();
        req.setUrl(url);

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5
